<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="theme-color" content="#2ecc71">
<title> SEO em Rails: Sitemap Metatags e Slug url | Adriano Godoy</title>
<meta name="description" content="SEO em Rails: Sitemap Metatags e Slug url">
<meta name="og:image" content="/images/bg.png">
<meta name="keywords" content="friendly_id, ruby on rails, seo, sitemap_generator, truncate_html">
<link rel="stylesheet" href="/css/main.css">
<link rel="canonical" href="http://godoy.net.br/ruby-on-rails/2016/seo-em-rails-sitemap-metatags-e-slug-url/">
<link rel="alternate" type="application/rss+xml" title="Adriano Godoy" href="http://godoy.net.br/feed.xml" />
<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-31336570-1']);
_gaq.push(['_trackPageview']);
(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>
<script>base_url = "";</script>
  </head>
  <body class="single">
    <main class="main-container">
        <header class="site-header">
  <div class="container txt-center">
    <a href="#" class="nav-toogle js-menu-trigger sliding-panel-button">
      <span></span>
      <span></span>
      <span></span>
    </a>
    <nav class="js-menu sliding-panel-content">
      <ul>
        <li><a href="/">home</a></li>
        <li><a href="/about">about</a></li>
        <li><a href="/feed.xml" target="_blank"><i class="icon icon-feed"></i> feed</a></li>
      </ul>
    </nav>
    <div class="js-menu-screen sliding-panel-fade-screen"></div>
    <a href="/" class="author-thumb dot">
      <img src="/images/author.jpg" alt="Author thumbnail" class="dot">
    </a>
      <h1 class="post-title">SEO em Rails: Sitemap Metatags e Slug url</h1>
      <p class="post-meta">Mar 6, 2016</p>
  </div>
</header>
        <section class="main-content">
          <article class="post">
  <div class="post-content container">
    <p>Neste post vou apresentar algumas dicas b√°sicas de SEO e aplic√°-las em um projeto Ruby on Rails explicando cada passo. J√° existem v√°rios blogs com dicas de SEO (<a href="http://www.seomaster.com.br/blog" target="_blank">SEO Master</a>, <a href="http://www.agenciamestre.com/blog/" target="_blank">Ag√™ncia Mestre</a>, <a href="https://moz.com/blog" target="_blank">MOZ</a>, etc), por isso focaremos em como aplicar as t√©cnicas e mostrar quais gems podem nos auxiliar.</p>
<p>O resultado dos passos aqui descritos resultaram neste projeto no Github: <a href="https://github.com/adrianogodoy/rails-seo" target="_blank">https://github.com/adrianogodoy/rails-seo</a>. Ap√≥s ler este post, se ainda restarem d√∫vidas, veja o log dos commits no github ou comente üòâ</p>
<h2 id="criando-a-aplicao-base-para-aplicar-as-tcnicas">Criando a aplica√ß√£o base para aplicar as t√©cnicas</h2>
<p>Para aplicar as t√©cnicas, vamos criar um site com uma administra√ß√£o de conte√∫do b√°sica. Criaremos os tipos Event (eventos), News (not√≠cias) e relacionaremos esses itens com o model Category (categorias).</p>
<p>N√£o nos preocuparemos com autentica√ß√£o de usu√°rios e valida√ß√µes pois n√£o s√£o relevantes para o conte√∫do abordado neste post.</p>
<p>Comece criando o projeto no <code>Terminal</code>:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">rails</span> <span class="kp">new</span> <span class="n">rails</span><span class="o">-</span><span class="n">seo</span></code></pre></div>
<p>Adicionaremos as gems <code>RailsAdmin</code> e <code>Paperclip</code>  apenas para facilitar a inser√ß√£o de conte√∫do no site. Vamos tamb√©m adicionar a gem <code>Bootstrap-Sass</code>.</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">gem</span> <span class="s2">&quot;paperclip&quot;</span><span class="p">,</span> <span class="s2">&quot;~&gt; 4.2&quot;</span>
<span class="n">gem</span> <span class="s2">&quot;rails_admin&quot;</span>
<span class="n">gem</span> <span class="s2">&quot;bootstrap-sass&quot;</span><span class="p">,</span> <span class="s2">&quot;~&gt; 3.3.3&quot;</span></code></pre></div>
<p>No terminal, instale o <code>rails_admin</code>:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">rails</span> <span class="n">g</span> <span class="ss">rails_admin</span><span class="p">:</span><span class="n">install</span></code></pre></div>
<p>Criando os models:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">rails</span> <span class="n">g</span> <span class="n">model</span> <span class="no">Category</span> <span class="nb">name</span>
<span class="n">rails</span> <span class="n">g</span> <span class="n">model</span> <span class="no">News</span> <span class="n">title</span> <span class="ss">category</span><span class="p">:</span><span class="n">references</span> <span class="ss">content</span><span class="p">:</span><span class="n">text</span> <span class="ss">image</span><span class="p">:</span><span class="n">attachment</span>
<span class="n">rails</span> <span class="n">g</span> <span class="n">model</span> <span class="no">Event</span> <span class="n">title</span> <span class="ss">category</span><span class="p">:</span><span class="n">references</span> <span class="ss">content</span><span class="p">:</span><span class="n">text</span> <span class="ss">image</span><span class="p">:</span><span class="n">attachment</span> <span class="ss">start_date</span><span class="p">:</span><span class="n">datetime</span> <span class="ss">end_date</span><span class="p">:</span><span class="n">datetime</span> <span class="n">place</span>
<span class="n">rake</span> <span class="ss">db</span><span class="p">:</span><span class="n">migrate</span></code></pre></div>
<p>Os models ficam da seguinte forma:</p>
<p>Arquivo <code>app/models/category.rb</code>:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">class</span> <span class="nc">Category</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">has_many</span> <span class="ss">:events</span>
  <span class="n">has_many</span> <span class="ss">:news</span>
<span class="k">end</span></code></pre></div>
<p><code>app/models/event.rb</code>:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">class</span> <span class="nc">Event</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">belongs_to</span> <span class="ss">:category</span>
  <span class="n">has_attached_file</span> <span class="ss">:image</span><span class="p">,</span> <span class="ss">:styles</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">:medium</span> <span class="o">=&gt;</span> <span class="s2">&quot;300x300&gt;&quot;</span><span class="p">,</span> <span class="ss">:thumb</span> <span class="o">=&gt;</span> <span class="s2">&quot;100x100&gt;&quot;</span> <span class="p">},</span> <span class="ss">:default_url</span> <span class="o">=&gt;</span> <span class="s2">&quot;/images/:style/missing.png&quot;</span>
  <span class="n">validates_attachment_content_type</span> <span class="ss">:image</span><span class="p">,</span> <span class="ss">:content_type</span> <span class="o">=&gt;</span> <span class="sr">/\Aimage\/.*\Z/</span>
<span class="k">end</span></code></pre></div>
<p><code>app/models/news.rb</code>:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">class</span> <span class="nc">News</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">belongs_to</span> <span class="ss">:category</span>
  <span class="n">has_attached_file</span> <span class="ss">:image</span><span class="p">,</span> <span class="ss">:styles</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">:medium</span> <span class="o">=&gt;</span> <span class="s2">&quot;300x300&gt;&quot;</span><span class="p">,</span> <span class="ss">:thumb</span> <span class="o">=&gt;</span> <span class="s2">&quot;100x100&gt;&quot;</span> <span class="p">},</span> <span class="ss">:default_url</span> <span class="o">=&gt;</span> <span class="s2">&quot;/images/:style/missing.png&quot;</span>
  <span class="n">validates_attachment_content_type</span> <span class="ss">:image</span><span class="p">,</span> <span class="ss">:content_type</span> <span class="o">=&gt;</span> <span class="sr">/\Aimage\/.*\Z/</span>
<span class="k">end</span></code></pre></div>
<p>Neste ponto j√° podemos cadastrar conte√∫do no admin. Sugiro carregar conte√∫do via seed ‚Äì <a href="http://godoy.net.br/ruby-on-rails/2015/importacao-de-conteudo-e-seed-no-rails/">veja neste post como criar o seed com lorem ipsum</a>.</p>
<p>Agora criaremos as rotas, views e controllers para a p√°gina home, lista e interna de noticias, lista e interna de eventos.</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">rails</span> <span class="n">g</span> <span class="n">controller</span> <span class="n">pages</span> <span class="n">home</span>
<span class="n">rails</span> <span class="n">g</span> <span class="n">controller</span> <span class="n">news</span> <span class="n">index</span> <span class="n">show</span>
<span class="n">rails</span> <span class="n">g</span> <span class="n">controller</span> <span class="n">events</span> <span class="n">index</span> <span class="n">show</span></code></pre></div>
<p>No arquivo de rotas, aponte o root para a home e deixe as rotas da seguinte forma:</p>
<p><code>config/routes.rb</code>:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="no">Rails</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">routes</span><span class="o">.</span><span class="n">draw</span> <span class="k">do</span>
  <span class="n">root</span> <span class="s1">&#39;pages#home&#39;</span>
  <span class="n">get</span> <span class="s1">&#39;events&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;events#index&#39;</span><span class="p">,</span> <span class="ss">as</span><span class="p">:</span> <span class="ss">:events</span>
  <span class="n">get</span> <span class="s1">&#39;events/:id&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;events#show&#39;</span><span class="p">,</span> <span class="ss">as</span><span class="p">:</span> <span class="ss">:event</span>
  <span class="n">get</span> <span class="s1">&#39;news&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;news#index&#39;</span><span class="p">,</span> <span class="ss">as</span><span class="p">:</span> <span class="ss">:news_index</span>
  <span class="n">get</span> <span class="s1">&#39;news/:id&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;news#show&#39;</span><span class="p">,</span> <span class="ss">as</span><span class="p">:</span> <span class="ss">:news</span>
  <span class="n">mount</span> <span class="no">RailsAdmin</span><span class="o">::</span><span class="no">Engine</span> <span class="o">=&gt;</span> <span class="s1">&#39;/admin&#39;</span><span class="p">,</span> <span class="ss">as</span><span class="p">:</span> <span class="s1">&#39;rails_admin&#39;</span>
<span class="k">end</span></code></pre></div>
<p>Ap√≥s configurar as rotas, inclua os scripts e css do Bootstrap no projeto. Siga os passos descritos na gem ou veja as modifica√ß√µes realizadas <a href="https://github.com/Godoy/rails-seo/commit/18cbd0f457dea06c755b50af549d56b7fb9af389" target="_blank">neste commit</a>.</p>
<p>Neste ponto j√° √© poss√≠vel acessar as p√°ginas de eventos e not√≠cias. Estamos prontos para come√ßar a aplicar as melhorias.</p>
<h2 id="ttulos-e-headers">T√≠tulos e Headers</h2>
<p>O t√≠tulo da p√°gina √© um dos elementos mais importantes para compor o SEO. Ele diz aos usu√°rios (e aos buscadores) qual conte√∫do ser√° apresentado na p√°gina. Para o title √© indicado um tamanho m√°ximo de 70 caracteres (cerca de 10 palavras). Al√©m disso, √© recomendado que cada p√°gina tenha um t√≠tulo √∫nico que a distingua das outras p√°ginas.</p>
<p>Um erro comum √© a repeti√ß√£o ou o uso indiscriminado da tag h1. Ela deve ocorrer uma √∫nica vez por p√°gina. Portanto n√£o √© aconselh√°vel colocar o nome do site, no header, dentro de uma tag h1. Deixe a tag para o t√≠tulo do conte√∫do que est√° sendo apresentado na p√°gina. Subt√≠tulos, sub-se√ß√µes e afins podem ser expressados com as tags h2, h3, etc. Estas podem se repetir na p√°gina.</p>
<p>Para facilitar a defini√ß√£o do t√≠tulo e header, utilizaremos a gem meta-tags. Adicione a gem ao seu Gemfile. Em seguida, no layout, substitua a linha da tag <title> pela seguinte:</title></p>
<p><code>app/views/layouts/application.html.erb</code>:</p>
<div class="highlight"><pre><code class="language-erb" data-lang="erb"><span class="cp">&lt;%=</span> <span class="n">display_meta_tags</span> <span class="ss">:site</span> <span class="o">=&gt;</span> <span class="s1">&#39;SEO no Rails&#39;</span><span class="p">,</span> <span class="ss">:reverse</span> <span class="o">=&gt;</span> <span class="kp">true</span> <span class="cp">%&gt;</span><span class="x"></span></code></pre></div>
<p>O valor de ‚Äúsite‚Äù corresponde ao nome do seu site. Utilizei a op√ß√£o ‚Äúreverse‚Äù true para que o nome do site seja repetido depois do t√≠tulo da p√°gina. Ficaria algo como:</p>
<p><em>T√≠tulo de exemplo da p√°gina | SEO no Rails</em></p>
<p>Al√©m disso, em cada view, coloque a tag h1:</p>
<div class="highlight"><pre><code class="language-erb" data-lang="erb"><span class="x">&lt;h1&gt;</span><span class="cp">&lt;%=</span> <span class="n">title</span> <span class="cp">%&gt;</span><span class="x">&lt;/h1&gt;</span></code></pre></div>
<p>Nos controllers defina o valor do title. As actions de eventos, por exemplo, ficam da seguinte forma:</p>
<p><code>app/controllers/events_controller.rb</code>:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">def</span> <span class="nf">index</span>
    <span class="vi">@events</span> <span class="o">=</span> <span class="no">Event</span><span class="o">.</span><span class="n">all</span>
    <span class="vi">@page_title</span> <span class="o">=</span> <span class="s1">&#39;Eventos&#39;</span>
  <span class="k">end</span>
  <span class="k">def</span> <span class="nf">show</span>
    <span class="vi">@page_title</span> <span class="o">=</span> <span class="vi">@event</span><span class="o">.</span><span class="n">title</span>
  <span class="k">end</span></code></pre></div>
<p>Simples! Veja <a href="https://github.com/Godoy/rails-seo/commit/51b180b5b32d5a9e18858c3c5a34f77edebb36e7" target="_blank">neste commit</a> as altera√ß√µes feitas em nosso projeto neste passo.</p>
<h2 id="metatags">Metatags</h2>
<p>Precisamos tamb√©m definir nossas metatags: description, keywords, al√©m das metatags do facebook. A description n√£o √© t√£o relevante para rankeamento quanto o t√≠tulo, mas √© extremamente importante para ganhar o clique do usu√°rio no resultado de busca. O indicado √© que a description possua entre 150 e 160 caracteres.</p>
<p>Da mesma forma, usaremos a gem meta-tags:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">class</span> <span class="nc">NewsController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="kp">include</span> <span class="no">ActionView</span><span class="o">::</span><span class="no">Helpers</span><span class="o">::</span><span class="no">TextHelper</span>
<span class="o">.</span><span class="n">.</span><span class="o">.</span>
  <span class="k">def</span> <span class="nf">show</span>
    <span class="vi">@page_title</span> <span class="o">=</span> <span class="vi">@news</span><span class="o">.</span><span class="n">title</span>
    <span class="vi">@page_description</span> <span class="o">=</span> <span class="n">truncate</span><span class="p">(</span><span class="vi">@news</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="ss">length</span><span class="p">:</span> <span class="mi">150</span><span class="p">,</span> <span class="ss">omission</span><span class="p">:</span> <span class="s1">&#39;...&#39;</span><span class="p">)</span>
    <span class="vi">@page_keywords</span>    <span class="o">=</span> <span class="vi">@news</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">gsub</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;, &#39;</span>
    <span class="n">set_meta_tags</span> <span class="ss">:og</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="ss">:title</span>    <span class="o">=&gt;</span> <span class="vi">@page_title</span><span class="p">,</span>
      <span class="ss">:image</span>    <span class="o">=&gt;</span> <span class="n">request</span><span class="o">.</span><span class="n">base_url</span><span class="o">+</span><span class="vi">@news</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">url</span><span class="p">,</span>
      <span class="ss">:description</span> <span class="o">=&gt;</span> <span class="vi">@page_description</span>
    <span class="p">}</span>
  <span class="k">end</span></code></pre></div>
<p>Para utilizar o helper truncate no texto, inclua-o no controller (linha 2). Apenas para exemplificar, no campo Keywords quebrei o t√≠tulo separando as palavras com v√≠rgulas. Para um projeto real, torne isso gerenci√°vel. Crie um novo campo ‚Äúkeywords‚Äù onde o administrador possa cadastrar keywords espec√≠ficas para cada conte√∫do. Fa√ßa o mesmo com a description. Ao inv√©s de utilizar os 150 primeiros caracteres (que podem n√£o ter nada relevante sendo dito), crie um campo administr√°vel, assim o usu√°rio pode inserir um texto mais interessante para chamar os usu√°rios para visitar a p√°gina. <a href="https://github.com/Godoy/rails-seo/commit/5f34929a7b50b6d9d4c40fc2f9730336ee88b0c5" target="_blank">Commit com as altera√ß√µes</a></p>
<h2 id="url-amigvel">URL Amig√°vel</h2>
<p>Al√©m da url ser um fator muito relevante para o rankeamento da p√°gina nos resultados de busca, ela √© outro importante mecanismo para transmitir ao usu√°rio qual ser√° o conte√∫do da p√°gina. (veja <a href="http://godoy.net.br/php/2008/urls-amigaveis---htaccess/" target="_blank">neste post como fazer em PHP utilizando .htaccess</a> ‚Äì old but gold üòÄ )</p>
<p>Para desenvolvermos esta feature no rails, mais uma vez faremos uso de uma gem: FriendlyId. No gemfile, adicione:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="no">Gemfile</span>
<span class="n">gem</span> <span class="s1">&#39;friendly_id&#39;</span><span class="p">,</span> <span class="s1">&#39;~&gt; 5.1.0&#39;</span></code></pre></div>
<p>Execute o bundle install e em seguida o comando:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">rails</span> <span class="n">generate</span> <span class="n">friendly_id</span></code></pre></div>
<p>Este comando ir√° gerar, al√©m do initializer, uma migration para cria√ß√£o de uma tabela onde ser√£o armazenados os slugs e o hist√≥rico de altera√ß√µes com correspond√™ncias de slugs. Precisamos tamb√©m criar o campo slug nos nossos tipos (not√≠cias, eventos e categorias). Execute as migrations:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">rails</span> <span class="n">generate</span> <span class="n">migration</span> <span class="n">add_slug_to_news</span> <span class="ss">slug</span><span class="p">:</span><span class="ss">string</span><span class="p">:</span><span class="n">uniq</span>
<span class="n">rails</span> <span class="n">generate</span> <span class="n">migration</span> <span class="n">add_slug_to_events</span> <span class="ss">slug</span><span class="p">:</span><span class="ss">string</span><span class="p">:</span><span class="n">uniq</span>
<span class="n">rails</span> <span class="n">generate</span> <span class="n">migration</span> <span class="n">add_slug_to_categories</span> <span class="ss">slug</span><span class="p">:</span><span class="ss">string</span><span class="p">:</span><span class="n">uniq</span>
<span class="n">rake</span> <span class="ss">db</span><span class="p">:</span><span class="n">migrate</span></code></pre></div>
<p>Agora podemos decorar os models para sinalizar qual campo devem utilizar para a cria√ß√£o do slug, como por exemplo no model News, que utilizaremos o campo title:</p>
<p><code>app/models/news.rb</code>:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">class</span> <span class="nc">News</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
<span class="o">.</span><span class="n">.</span><span class="o">.</span>
  <span class="kp">extend</span> <span class="no">FriendlyId</span>
  <span class="n">friendly_id</span> <span class="ss">:title</span><span class="p">,</span> <span class="ss">use</span><span class="p">:</span> <span class="ss">:slugged</span>
<span class="k">end</span></code></pre></div>
<p>No caso de eventos, √© poss√≠vel fazer um combo bacana na gera√ß√£o dos slugs, concatenando a data com o t√≠tulo do evento:</p>
<p><code>app/models/event.rb</code>:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">class</span> <span class="nc">Event</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
<span class="o">.</span><span class="n">.</span><span class="o">.</span>
  <span class="kp">extend</span> <span class="no">FriendlyId</span>
  <span class="n">friendly_id</span> <span class="ss">:my_method_slug</span><span class="p">,</span> <span class="ss">use</span><span class="p">:</span> <span class="ss">:slugged</span>
  <span class="k">def</span> <span class="nf">my_method_slug</span>
    <span class="n">start_date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%m/%d/%Y&quot;</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; - </span><span class="si">#{</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></div>
<p>Como j√° hav√≠amos cadastrado nosso conte√∫do de teste, precisamos salvar novamente todos os registros para que seus slugs sejam gerados. O comando para ser executado no rails console √© simples. Veja <a href="https://gist.github.com/Godoy/6564097" target="_blank">neste gist</a>.</p>
<p>Na listagem de not√≠cias (http://localhost:3000/news) j√° √© poss√≠vel ver a nova URL sendo automaticamente gerada passando o slug ao inv√©s do id. Agora s√≥ precisamos alterar a forma como os registros s√£o buscados no controller:</p>
<p><code>app/controllers/events_controller.rb</code>:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">class</span> <span class="nc">EventsController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
<span class="o">.</span><span class="n">.</span><span class="o">.</span>
  <span class="kp">private</span>
    <span class="k">def</span> <span class="nf">set_event</span>
      <span class="vi">@event</span> <span class="o">=</span> <span class="no">Event</span><span class="o">.</span><span class="n">friendly</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:id</span><span class="o">]</span><span class="p">)</span>
    <span class="k">end</span>
<span class="k">end</span></code></pre></div>
<p>Done!</p>
<p>OBS: Para impedir que o slug gerado automaticamente seja sobrescrito ou apagado pelo usu√°rio no rails_admin, exclua o campo slug dos formul√°rios no rails_admin inserindo o seguinte no seu model:</p>
<p><code>app/models/event.rb</code>:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">class</span> <span class="nc">Event</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
<span class="o">.</span><span class="n">.</span><span class="o">.</span>
  <span class="n">rails_admin</span> <span class="k">do</span>
    <span class="n">create</span> <span class="k">do</span>
      <span class="n">exclude_fields</span> <span class="ss">:slug</span>
    <span class="k">end</span>
    <span class="n">edit</span> <span class="k">do</span>
      <span class="n">exclude_fields</span> <span class="ss">:slug</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></div>
<p><a href="https://github.com/Godoy/rails-seo/commit/c3df3da6377ee6ebc094de8f09f83c8a154d48cd" target="_blank">Clique aqui</a> para ver o commit com as altera√ß√µes.</p>
<h2 id="sitemap">Sitemap</h2>
<p>O <a href="https://support.google.com/webmasters/answer/183668?hl=en" target="_blank">sitemap</a> √© uma forma na qual o webmaster pode auxiliar (e agilizar) a indexa√ß√£o do site. Permite sugerir aos rob√¥s de busca quais p√°ginas devem ser indexadas, qual frequ√™ncia de rastreamento, data da √∫ltima modifica√ß√£o da p√°gina e a prioridade em rela√ß√£o √†s outras p√°ginas do arquivo.</p>
<p>Utilizaremos a gem <code>Sitemap Generator</code>. Adicione a gem ao seu Gemfile e execute o comando:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">rake</span> <span class="ss">sitemap</span><span class="p">:</span><span class="n">install</span></code></pre></div>
<p>No arquivo de configura√ß√£o gerado, vamos inserir nossas p√°ginas e rotas para os conte√∫dos:</p>
<p><code>config/sitemap.rb</code>:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># Set the host name for URL creation</span>
<span class="no">SitemapGenerator</span><span class="o">::</span><span class="no">Sitemap</span><span class="o">.</span><span class="n">default_host</span> <span class="o">=</span> <span class="s2">&quot;http://localhost:3000&quot;</span>
<span class="no">SitemapGenerator</span><span class="o">::</span><span class="no">Sitemap</span><span class="o">.</span><span class="n">create</span> <span class="k">do</span>
  <span class="n">add</span> <span class="n">news_path</span><span class="p">,</span> <span class="ss">:priority</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="o">.</span><span class="mi">7</span><span class="p">,</span> <span class="ss">:changefreq</span> <span class="o">=&gt;</span> <span class="s1">&#39;daily&#39;</span>
  <span class="no">News</span><span class="o">.</span><span class="n">find_each</span> <span class="k">do</span> <span class="o">|</span><span class="n">item</span><span class="o">|</span>
    <span class="n">add</span> <span class="n">news_path</span><span class="p">(</span><span class="n">item</span><span class="p">),</span> <span class="ss">:lastmod</span> <span class="o">=&gt;</span> <span class="n">item</span><span class="o">.</span><span class="n">updated_at</span>
  <span class="k">end</span>
  <span class="n">add</span> <span class="n">events_path</span><span class="p">,</span> <span class="ss">:priority</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="o">.</span><span class="mi">7</span><span class="p">,</span> <span class="ss">:changefreq</span> <span class="o">=&gt;</span> <span class="s1">&#39;daily&#39;</span>
  <span class="no">Event</span><span class="o">.</span><span class="n">find_each</span> <span class="k">do</span> <span class="o">|</span><span class="n">item</span><span class="o">|</span>
    <span class="n">add</span> <span class="n">event_path</span><span class="p">(</span><span class="n">item</span><span class="p">),</span> <span class="ss">:lastmod</span> <span class="o">=&gt;</span> <span class="n">item</span><span class="o">.</span><span class="n">updated_at</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></div>
<p>A p√°gina inicial j√° √© incluida por default. Execute o seguinte para gerar o sitemap baseado nas configura√ß√µes:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">rake</span> <span class="ss">sitemap</span><span class="p">:</span><span class="n">refresh</span></code></pre></div>
<p>E confira o seu sitemap gerado em <code>/public/sitemap.xml.gz</code>:</p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml">...
  <span class="nt">&lt;url&gt;</span>
      <span class="nt">&lt;loc&gt;</span>http://localhost:3000<span class="nt">&lt;/loc&gt;</span>
    <span class="nt">&lt;lastmod&gt;</span>2015-03-06T21:49:01-03:00<span class="nt">&lt;/lastmod&gt;</span>
    <span class="nt">&lt;changefreq&gt;</span>always<span class="nt">&lt;/changefreq&gt;</span>
    <span class="nt">&lt;priority&gt;</span>1.0<span class="nt">&lt;/priority&gt;</span>
  <span class="nt">&lt;/url&gt;</span>
  <span class="nt">&lt;url&gt;</span>
    <span class="nt">&lt;loc&gt;</span>http://localhost:3000/noticias<span class="nt">&lt;/loc&gt;</span>
    <span class="nt">&lt;lastmod&gt;</span>2015-03-06T21:49:01-03:00<span class="nt">&lt;/lastmod&gt;</span>
    <span class="nt">&lt;changefreq&gt;</span>daily<span class="nt">&lt;/changefreq&gt;</span>
    <span class="nt">&lt;priority&gt;</span>0.7<span class="nt">&lt;/priority&gt;</span>
  <span class="nt">&lt;/url&gt;</span>
  <span class="nt">&lt;url&gt;</span>
    <span class="nt">&lt;loc&gt;</span>http://localhost:3000/noticias/optio-minima-exercitationem-dolor<span class="nt">&lt;/loc&gt;</span>
    <span class="nt">&lt;lastmod&gt;</span>2015-03-07T00:19:29+00:00<span class="nt">&lt;/lastmod&gt;</span>
    <span class="nt">&lt;changefreq&gt;</span>weekly<span class="nt">&lt;/changefreq&gt;</span>
    <span class="nt">&lt;priority&gt;</span>0.5<span class="nt">&lt;/priority&gt;</span>
  <span class="nt">&lt;/url&gt;</span>
...</code></pre></div>
<p>Veja o <a href="https://github.com/Godoy/rails-seo/commit/56cad016d28fee5fc83711408ebf60a1d5309a53" target="_blank">commit</a> com as altera√ß√µes para Sitemap.</p>
<h2 id="crie-contedo-e-monitore">Crie conte√∫do e monitore!</h2>
<p>Com as dicas b√°sicas dadas neste artigo sua p√°gina estar√° em boas condi√ß√µes de aparecer nas buscas dos usu√°rios pelo conte√∫do do seu site. Lembre-se: antes de qualquer t√©cnica, seu site precisa ter conte√∫do!</p>
<p>As t√©cnicas de SEO existem para tornar claro qual o conte√∫do de seu site e permitir que os buscadores exponham seu conte√∫do quando for relevante para a busca feita.</p>
<p>Fa√ßa o monitoramento de seu site. Acompanhe no Google Analytics o perfil de seu visitante, quais p√°ginas s√£o mais acessadas e as origens de tr√°fego.</p>
<p>Cadastre seu site no Google Webmasters (http://www.google.com.br/webmasters/) e receba feedbacks de melhorias e erros no seu site.</p>
<p>Em breve farei um post sobre microdados e utilizarei este mesmo projeto como base!</p>
<p>D√∫vidas e sugest√µes s√£o bem vindas üòâ</p>
    <aside class="share">
      <span>Compartilhe: </span>
      <!-- Go to www.addthis.com/dashboard to customize your tools -->
      <div class="addthis_inline_share_toolbox"></div>
    </aside>
  </div>
  <hr>
  <aside id="comments" class="disqus">
    <div class="container">
      <h3><i class="icon icon-comments-o"></i> Comments</h3>
      <div id="disqus_thread"></div>
      <script type="text/javascript">
        var disqus_shortname = 'adrianogodoy';
        var disqus_identifier = '/ruby-on-rails/2016/seo-em-rails-sitemap-metatags-e-slug-url';
        var disqus_title = 'SEO em Rails: Sitemap Metatags e Slug url';
        var disqus_url = 'http://godoy.net.br';
        /*var disqus_developer = 1;*/
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
      </script>
      <noscript>
        Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
      </noscript>
    </div>
  </aside>
</article>
        </section>
<div class="clearfix"></div>
<footer class="site-footer txt-center">
  <hr>
  <ul class="social">
  </ul>
</footer>
    </main>
    <!-- <a href="https://github.com/Godoy/godoy.github.io.git" target="_blank" class="github-corner"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#000; color:#fff; position: absolute; top: 0; border: 0; right: 0;"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a> -->
    <script src="/js/jquery.min.js"></script>
    <script src="/js/jekyll-search.min.js"></script>
    <script src="/js/main.js"></script>
    <!-- Go to www.addthis.com/dashboard to customize your tools -->
    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4ea16b894211cc28"></script>
  </body>
</html>
